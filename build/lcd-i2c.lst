ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 2
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"lcd-i2c.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.I2C_Scan,"ax",%progbits
  16              		.align	1
  17              		.p2align 2,,3
  18              		.global	I2C_Scan
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu softvfp
  24              	I2C_Scan:
  25              	.LFB706:
  26              		.file 1 "stm32/lcd-i2c.c"
   1:stm32/lcd-i2c.c **** /*
   2:stm32/lcd-i2c.c ****  * TODO: this is not done
   3:stm32/lcd-i2c.c ****  *
   4:stm32/lcd-i2c.c ****   lcd-i2c.c - I2C LCD display control
   5:stm32/lcd-i2c.c ****   Part of Grbl32
   6:stm32/lcd-i2c.c **** 
   7:stm32/lcd-i2c.c ****   Copyright (c) 2018-2019 Thomas Truong
   8:stm32/lcd-i2c.c **** 
   9:stm32/lcd-i2c.c ****   Grbl is free software: you can redistribute it and/or modify
  10:stm32/lcd-i2c.c ****   it under the terms of the GNU General Public License as published by
  11:stm32/lcd-i2c.c ****   the Free Software Foundation, either version 3 of the License, or
  12:stm32/lcd-i2c.c ****   (at your option) any later version.
  13:stm32/lcd-i2c.c **** 
  14:stm32/lcd-i2c.c ****   Grbl is distributed in the hope that it will be useful,
  15:stm32/lcd-i2c.c ****   but WITHOUT ANY WARRANTY; without even the implied warranty of
  16:stm32/lcd-i2c.c ****   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  17:stm32/lcd-i2c.c ****   GNU General Public License for more details.
  18:stm32/lcd-i2c.c **** 
  19:stm32/lcd-i2c.c ****   You should have received a copy of the GNU General Public License
  20:stm32/lcd-i2c.c ****   along with Grbl.  If not, see <http://www.gnu.org/licenses/>.
  21:stm32/lcd-i2c.c **** */
  22:stm32/lcd-i2c.c **** 
  23:stm32/lcd-i2c.c **** #include <stdio.h>
  24:stm32/lcd-i2c.c **** #include <string.h>
  25:stm32/lcd-i2c.c **** #include "lcd-i2c.h"
  26:stm32/lcd-i2c.c **** #include "stm32utilities.h"
  27:stm32/lcd-i2c.c **** 
  28:stm32/lcd-i2c.c **** 
  29:stm32/lcd-i2c.c **** #if ( defined(STM32F13) || defined(STM32F46) )	//-- only available on F13 and F46
  30:stm32/lcd-i2c.c **** 
  31:stm32/lcd-i2c.c **** #define LCD_ADDR (0x27 << 1)
  32:stm32/lcd-i2c.c **** #define PIN_RS    (1 << 0)
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 2


  33:stm32/lcd-i2c.c **** #define PIN_EN    (1 << 2)
  34:stm32/lcd-i2c.c **** #define BACKLIGHT (1 << 3)
  35:stm32/lcd-i2c.c **** #define LCD_DELAY_MS 5
  36:stm32/lcd-i2c.c **** 
  37:stm32/lcd-i2c.c **** I2C_HandleTypeDef *pHI2C = NULL;
  38:stm32/lcd-i2c.c **** 
  39:stm32/lcd-i2c.c **** 
  40:stm32/lcd-i2c.c **** 
  41:stm32/lcd-i2c.c **** //-------------------------------------------------------------------------------
  42:stm32/lcd-i2c.c **** void I2C_Scan()
  43:stm32/lcd-i2c.c **** {
  27              		.loc 1 43 0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 88
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31 0000 F0B5     		push	{r4, r5, r6, r7, lr}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 20
  34              		.cfi_offset 4, -20
  35              		.cfi_offset 5, -16
  36              		.cfi_offset 6, -12
  37              		.cfi_offset 7, -8
  38              		.cfi_offset 14, -4
  39 0002 97B0     		sub	sp, sp, #92
  40              	.LCFI1:
  41              		.cfi_def_cfa_offset 112
  44:stm32/lcd-i2c.c ****   char info[] = "Scanning I2C bus...\r\n";
  42              		.loc 1 44 0
  43 0004 6C46     		mov	r4, sp
  44 0006 174D     		ldr	r5, .L10
  45              	.LBB12:
  45:stm32/lcd-i2c.c ****   uart_sendstr(info);
  46:stm32/lcd-i2c.c **** 
  47:stm32/lcd-i2c.c ****   HAL_StatusTypeDef res;
  48:stm32/lcd-i2c.c ****   for (uint16_t i = 0; i < 128; i++)
  49:stm32/lcd-i2c.c ****     {
  50:stm32/lcd-i2c.c ****     res = HAL_I2C_IsDeviceReady(pHI2C, i << 1, 1, 10);
  51:stm32/lcd-i2c.c ****     if (res == HAL_OK)
  52:stm32/lcd-i2c.c ****       {
  53:stm32/lcd-i2c.c ****       char msg[64];
  54:stm32/lcd-i2c.c ****       sprintf(msg, "0x%02X", i);
  55:stm32/lcd-i2c.c ****       uart_sendstr(msg);
  56:stm32/lcd-i2c.c ****       }
  57:stm32/lcd-i2c.c ****     else
  58:stm32/lcd-i2c.c ****       {
  59:stm32/lcd-i2c.c ****       uart_sendstr(".");
  46              		.loc 1 59 0
  47 0008 174F     		ldr	r7, .L10+4
  48              	.LBE12:
  44:stm32/lcd-i2c.c ****   char info[] = "Scanning I2C bus...\r\n";
  49              		.loc 1 44 0
  50 000a 0FCD     		ldmia	r5!, {r0, r1, r2, r3}
  51 000c 0FC4     		stmia	r4!, {r0, r1, r2, r3}
  52 000e 95E80300 		ldm	r5, {r0, r1}
  53 0012 44F8040B 		str	r0, [r4], #4
  45:stm32/lcd-i2c.c ****   uart_sendstr(info);
  54              		.loc 1 45 0
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 3


  55 0016 6846     		mov	r0, sp
  44:stm32/lcd-i2c.c ****   char info[] = "Scanning I2C bus...\r\n";
  56              		.loc 1 44 0
  57 0018 2180     		strh	r1, [r4]	@ movhi
  58 001a 144D     		ldr	r5, .L10+8
  45:stm32/lcd-i2c.c ****   uart_sendstr(info);
  59              		.loc 1 45 0
  60 001c 0024     		movs	r4, #0
  61 001e FFF7FEFF 		bl	uart_sendstr
  62              	.LVL0:
  63              	.LBB14:
  64              	.LBB13:
  54:stm32/lcd-i2c.c ****       uart_sendstr(msg);
  65              		.loc 1 54 0
  66 0022 134E     		ldr	r6, .L10+12
  67 0024 0AE0     		b	.L4
  68              	.LVL1:
  69              	.L9:
  70 0026 2246     		mov	r2, r4
  71 0028 3146     		mov	r1, r6
  72 002a 06A8     		add	r0, sp, #24
  73              	.LVL2:
  74 002c FFF7FEFF 		bl	sprintf
  75              	.LVL3:
  76 0030 0134     		adds	r4, r4, #1
  77              	.LVL4:
  55:stm32/lcd-i2c.c ****       }
  78              		.loc 1 55 0
  79 0032 06A8     		add	r0, sp, #24
  80 0034 FFF7FEFF 		bl	uart_sendstr
  81              	.LVL5:
  82              	.LBE13:
  48:stm32/lcd-i2c.c ****     {
  83              		.loc 1 48 0
  84 0038 802C     		cmp	r4, #128
  85 003a 0ED0     		beq	.L8
  86              	.L4:
  87              	.LVL6:
  50:stm32/lcd-i2c.c ****     if (res == HAL_OK)
  88              		.loc 1 50 0
  89 003c 6100     		lsls	r1, r4, #1
  90 003e 89B2     		uxth	r1, r1
  91 0040 0A23     		movs	r3, #10
  92 0042 0122     		movs	r2, #1
  93 0044 2868     		ldr	r0, [r5]
  94 0046 FFF7FEFF 		bl	HAL_I2C_IsDeviceReady
  95              	.LVL7:
  51:stm32/lcd-i2c.c ****       {
  96              		.loc 1 51 0
  97 004a 0028     		cmp	r0, #0
  98 004c EBD0     		beq	.L9
  99              		.loc 1 59 0
 100 004e 3846     		mov	r0, r7
 101              	.LVL8:
 102 0050 0134     		adds	r4, r4, #1
 103              	.LVL9:
 104 0052 FFF7FEFF 		bl	uart_sendstr
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 4


 105              	.LVL10:
  48:stm32/lcd-i2c.c ****     {
 106              		.loc 1 48 0
 107 0056 802C     		cmp	r4, #128
 108 0058 F0D1     		bne	.L4
 109              	.L8:
 110              	.LBE14:
  60:stm32/lcd-i2c.c ****       }
  61:stm32/lcd-i2c.c ****     }
  62:stm32/lcd-i2c.c **** 
  63:stm32/lcd-i2c.c ****   uart_sendstr("\r\n");
 111              		.loc 1 63 0
 112 005a 0648     		ldr	r0, .L10+16
 113 005c FFF7FEFF 		bl	uart_sendstr
 114              	.LVL11:
  64:stm32/lcd-i2c.c **** }
 115              		.loc 1 64 0
 116 0060 17B0     		add	sp, sp, #92
 117              	.LCFI2:
 118              		.cfi_def_cfa_offset 20
 119              		@ sp needed
 120 0062 F0BD     		pop	{r4, r5, r6, r7, pc}
 121              	.L11:
 122              		.align	2
 123              	.L10:
 124 0064 10000000 		.word	.LC0
 125 0068 08000000 		.word	.LC2
 126 006c 00000000 		.word	.LANCHOR0
 127 0070 00000000 		.word	.LC1
 128 0074 0C000000 		.word	.LC3
 129              		.cfi_endproc
 130              	.LFE706:
 132              		.section	.text.LCD_SendInternal,"ax",%progbits
 133              		.align	1
 134              		.p2align 2,,3
 135              		.global	LCD_SendInternal
 136              		.syntax unified
 137              		.thumb
 138              		.thumb_func
 139              		.fpu softvfp
 141              	LCD_SendInternal:
 142              	.LFB707:
  65:stm32/lcd-i2c.c **** //-------------------------------------------------------------------------------
  66:stm32/lcd-i2c.c **** HAL_StatusTypeDef LCD_SendInternal(uint8_t lcd_addr, uint8_t data, uint8_t flags)
  67:stm32/lcd-i2c.c **** {
 143              		.loc 1 67 0
 144              		.cfi_startproc
 145              		@ args = 0, pretend = 0, frame = 8
 146              		@ frame_needed = 0, uses_anonymous_args = 0
 147              	.LVL12:
 148 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 149              	.LCFI3:
 150              		.cfi_def_cfa_offset 20
 151              		.cfi_offset 4, -20
 152              		.cfi_offset 5, -16
 153              		.cfi_offset 6, -12
 154              		.cfi_offset 7, -8
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 5


 155              		.cfi_offset 14, -4
 156 0002 0C46     		mov	r4, r1
 157 0004 1746     		mov	r7, r2
 158 0006 0546     		mov	r5, r0
 159 0008 184E     		ldr	r6, .L16
 160 000a 85B0     		sub	sp, sp, #20
 161              	.LCFI4:
 162              		.cfi_def_cfa_offset 40
 163              	.LVL13:
 164              	.L13:
  68:stm32/lcd-i2c.c ****   HAL_StatusTypeDef res;
  69:stm32/lcd-i2c.c ****   for (;;)
  70:stm32/lcd-i2c.c ****     {
  71:stm32/lcd-i2c.c ****     res = HAL_I2C_IsDeviceReady(pHI2C, lcd_addr, 1, HAL_MAX_DELAY);
 165              		.loc 1 71 0
 166 000c 4FF0FF33 		mov	r3, #-1
 167 0010 0122     		movs	r2, #1
 168 0012 2946     		mov	r1, r5
 169 0014 3068     		ldr	r0, [r6]
 170 0016 FFF7FEFF 		bl	HAL_I2C_IsDeviceReady
 171              	.LVL14:
  72:stm32/lcd-i2c.c ****     if (res == HAL_OK)
 172              		.loc 1 72 0
 173 001a 0028     		cmp	r0, #0
 174 001c F6D1     		bne	.L13
 175              	.LVL15:
  73:stm32/lcd-i2c.c ****       break;
  74:stm32/lcd-i2c.c ****     }
  75:stm32/lcd-i2c.c **** 
  76:stm32/lcd-i2c.c ****   uint8_t up = data & 0xF0;
  77:stm32/lcd-i2c.c ****   uint8_t lo = (data << 4) & 0xF0;
  78:stm32/lcd-i2c.c **** 
  79:stm32/lcd-i2c.c ****   uint8_t data_arr[4];
  80:stm32/lcd-i2c.c ****   data_arr[0] = up | flags | BACKLIGHT | PIN_EN;
  81:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
  82:stm32/lcd-i2c.c ****   data_arr[2] = lo | flags | BACKLIGHT | PIN_EN;
  83:stm32/lcd-i2c.c ****   data_arr[3] = lo | flags | BACKLIGHT;
  84:stm32/lcd-i2c.c **** 
  85:stm32/lcd-i2c.c ****   res = HAL_I2C_Master_Transmit(pHI2C, lcd_addr, data_arr, sizeof(data_arr), HAL_MAX_DELAY);
 176              		.loc 1 85 0
 177 001e 4FF0FF32 		mov	r2, #-1
  76:stm32/lcd-i2c.c ****   uint8_t lo = (data << 4) & 0xF0;
 178              		.loc 1 76 0
 179 0022 24F00F03 		bic	r3, r4, #15
  82:stm32/lcd-i2c.c ****   data_arr[3] = lo | flags | BACKLIGHT;
 180              		.loc 1 82 0
 181 0026 47EA0414 		orr	r4, r7, r4, lsl #4
 182              	.LVL16:
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 183              		.loc 1 80 0
 184 002a 1F43     		orrs	r7, r7, r3
 185 002c 47F00C03 		orr	r3, r7, #12
  82:stm32/lcd-i2c.c ****   data_arr[3] = lo | flags | BACKLIGHT;
 186              		.loc 1 82 0
 187 0030 E4B2     		uxtb	r4, r4
 188              		.loc 1 85 0
 189 0032 2946     		mov	r1, r5
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 6


 190 0034 0092     		str	r2, [sp]
  82:stm32/lcd-i2c.c ****   data_arr[3] = lo | flags | BACKLIGHT;
 191              		.loc 1 82 0
 192 0036 44F00C05 		orr	r5, r4, #12
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 193              		.loc 1 80 0
 194 003a 8DF80C30 		strb	r3, [sp, #12]
 195              		.loc 1 85 0
 196 003e 03AA     		add	r2, sp, #12
 197 0040 0423     		movs	r3, #4
 198 0042 3068     		ldr	r0, [r6]
 199              	.LVL17:
  81:stm32/lcd-i2c.c ****   data_arr[2] = lo | flags | BACKLIGHT | PIN_EN;
 200              		.loc 1 81 0
 201 0044 47F00807 		orr	r7, r7, #8
  83:stm32/lcd-i2c.c **** 
 202              		.loc 1 83 0
 203 0048 44F00804 		orr	r4, r4, #8
 204 004c 8DF80F40 		strb	r4, [sp, #15]
  81:stm32/lcd-i2c.c ****   data_arr[2] = lo | flags | BACKLIGHT | PIN_EN;
 205              		.loc 1 81 0
 206 0050 8DF80D70 		strb	r7, [sp, #13]
  82:stm32/lcd-i2c.c ****   data_arr[3] = lo | flags | BACKLIGHT;
 207              		.loc 1 82 0
 208 0054 8DF80E50 		strb	r5, [sp, #14]
 209              		.loc 1 85 0
 210 0058 FFF7FEFF 		bl	HAL_I2C_Master_Transmit
 211              	.LVL18:
 212 005c 0446     		mov	r4, r0
 213              	.LVL19:
  86:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 214              		.loc 1 86 0
 215 005e 0520     		movs	r0, #5
 216 0060 FFF7FEFF 		bl	HAL_Delay
 217              	.LVL20:
  87:stm32/lcd-i2c.c ****   return res;
  88:stm32/lcd-i2c.c **** }
 218              		.loc 1 88 0
 219 0064 2046     		mov	r0, r4
 220 0066 05B0     		add	sp, sp, #20
 221              	.LCFI5:
 222              		.cfi_def_cfa_offset 20
 223              		@ sp needed
 224 0068 F0BD     		pop	{r4, r5, r6, r7, pc}
 225              	.LVL21:
 226              	.L17:
 227 006a 00BF     		.align	2
 228              	.L16:
 229 006c 00000000 		.word	.LANCHOR0
 230              		.cfi_endproc
 231              	.LFE707:
 233              		.section	.text.LCD_SendCommand,"ax",%progbits
 234              		.align	1
 235              		.p2align 2,,3
 236              		.global	LCD_SendCommand
 237              		.syntax unified
 238              		.thumb
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 7


 239              		.thumb_func
 240              		.fpu softvfp
 242              	LCD_SendCommand:
 243              	.LFB708:
  89:stm32/lcd-i2c.c **** //-------------------------------------------------------------------------------
  90:stm32/lcd-i2c.c **** void LCD_SendCommand(uint8_t lcd_addr, uint8_t cmd)
  91:stm32/lcd-i2c.c **** {
 244              		.loc 1 91 0
 245              		.cfi_startproc
 246              		@ args = 0, pretend = 0, frame = 8
 247              		@ frame_needed = 0, uses_anonymous_args = 0
 248              	.LVL22:
 249 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 250              	.LCFI6:
 251              		.cfi_def_cfa_offset 20
 252              		.cfi_offset 4, -20
 253              		.cfi_offset 5, -16
 254              		.cfi_offset 6, -12
 255              		.cfi_offset 7, -8
 256              		.cfi_offset 14, -4
 257 0002 0E46     		mov	r6, r1
 258              	.LVL23:
 259 0004 0446     		mov	r4, r0
 260 0006 164D     		ldr	r5, .L22
 261 0008 85B0     		sub	sp, sp, #20
 262              	.LCFI7:
 263              		.cfi_def_cfa_offset 40
 264              	.LVL24:
 265              	.L19:
 266              	.LBB17:
 267              	.LBB18:
  71:stm32/lcd-i2c.c ****     if (res == HAL_OK)
 268              		.loc 1 71 0
 269 000a 4FF0FF33 		mov	r3, #-1
 270 000e 0122     		movs	r2, #1
 271 0010 2146     		mov	r1, r4
 272 0012 2868     		ldr	r0, [r5]
 273 0014 FFF7FEFF 		bl	HAL_I2C_IsDeviceReady
 274              	.LVL25:
  72:stm32/lcd-i2c.c ****       break;
 275              		.loc 1 72 0
 276 0018 0028     		cmp	r0, #0
 277 001a F6D1     		bne	.L19
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 278              		.loc 1 85 0
 279 001c 4FF0FF37 		mov	r7, #-1
  77:stm32/lcd-i2c.c **** 
 280              		.loc 1 77 0
 281 0020 3301     		lsls	r3, r6, #4
 282 0022 DBB2     		uxtb	r3, r3
  83:stm32/lcd-i2c.c **** 
 283              		.loc 1 83 0
 284 0024 43F00802 		orr	r2, r3, #8
  76:stm32/lcd-i2c.c ****   uint8_t lo = (data << 4) & 0xF0;
 285              		.loc 1 76 0
 286 0028 06F0F006 		and	r6, r6, #240
 287              	.LVL26:
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 8


  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 288              		.loc 1 85 0
 289 002c 2146     		mov	r1, r4
 290 002e 2868     		ldr	r0, [r5]
 291              	.LVL27:
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 292              		.loc 1 80 0
 293 0030 46F00C04 		orr	r4, r6, #12
  82:stm32/lcd-i2c.c ****   data_arr[3] = lo | flags | BACKLIGHT;
 294              		.loc 1 82 0
 295 0034 43F00C05 		orr	r5, r3, #12
  83:stm32/lcd-i2c.c **** 
 296              		.loc 1 83 0
 297 0038 8DF80F20 		strb	r2, [sp, #15]
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 298              		.loc 1 85 0
 299 003c 0423     		movs	r3, #4
 300              	.LVL28:
 301 003e 03AA     		add	r2, sp, #12
 302 0040 0097     		str	r7, [sp]
  81:stm32/lcd-i2c.c ****   data_arr[2] = lo | flags | BACKLIGHT | PIN_EN;
 303              		.loc 1 81 0
 304 0042 46F00806 		orr	r6, r6, #8
 305              	.LVL29:
  82:stm32/lcd-i2c.c ****   data_arr[3] = lo | flags | BACKLIGHT;
 306              		.loc 1 82 0
 307 0046 8DF80E50 		strb	r5, [sp, #14]
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 308              		.loc 1 80 0
 309 004a 8DF80C40 		strb	r4, [sp, #12]
  81:stm32/lcd-i2c.c ****   data_arr[2] = lo | flags | BACKLIGHT | PIN_EN;
 310              		.loc 1 81 0
 311 004e 8DF80D60 		strb	r6, [sp, #13]
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 312              		.loc 1 85 0
 313 0052 FFF7FEFF 		bl	HAL_I2C_Master_Transmit
 314              	.LVL30:
  86:stm32/lcd-i2c.c ****   return res;
 315              		.loc 1 86 0
 316 0056 0520     		movs	r0, #5
 317 0058 FFF7FEFF 		bl	HAL_Delay
 318              	.LVL31:
 319              	.LBE18:
 320              	.LBE17:
  92:stm32/lcd-i2c.c ****   LCD_SendInternal(lcd_addr, cmd, 0);
  93:stm32/lcd-i2c.c **** }
 321              		.loc 1 93 0
 322 005c 05B0     		add	sp, sp, #20
 323              	.LCFI8:
 324              		.cfi_def_cfa_offset 20
 325              		@ sp needed
 326 005e F0BD     		pop	{r4, r5, r6, r7, pc}
 327              	.L23:
 328              		.align	2
 329              	.L22:
 330 0060 00000000 		.word	.LANCHOR0
 331              		.cfi_endproc
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 9


 332              	.LFE708:
 334              		.section	.text.LCD_SendData,"ax",%progbits
 335              		.align	1
 336              		.p2align 2,,3
 337              		.global	LCD_SendData
 338              		.syntax unified
 339              		.thumb
 340              		.thumb_func
 341              		.fpu softvfp
 343              	LCD_SendData:
 344              	.LFB709:
  94:stm32/lcd-i2c.c **** //-------------------------------------------------------------------------------
  95:stm32/lcd-i2c.c **** void LCD_SendData(uint8_t lcd_addr, uint8_t data)
  96:stm32/lcd-i2c.c **** {
 345              		.loc 1 96 0
 346              		.cfi_startproc
 347              		@ args = 0, pretend = 0, frame = 8
 348              		@ frame_needed = 0, uses_anonymous_args = 0
 349              	.LVL32:
 350 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 351              	.LCFI9:
 352              		.cfi_def_cfa_offset 20
 353              		.cfi_offset 4, -20
 354              		.cfi_offset 5, -16
 355              		.cfi_offset 6, -12
 356              		.cfi_offset 7, -8
 357              		.cfi_offset 14, -4
 358 0002 0E46     		mov	r6, r1
 359              	.LVL33:
 360 0004 0446     		mov	r4, r0
 361 0006 164D     		ldr	r5, .L28
 362 0008 85B0     		sub	sp, sp, #20
 363              	.LCFI10:
 364              		.cfi_def_cfa_offset 40
 365              	.LVL34:
 366              	.L25:
 367              	.LBB21:
 368              	.LBB22:
  71:stm32/lcd-i2c.c ****     if (res == HAL_OK)
 369              		.loc 1 71 0
 370 000a 4FF0FF33 		mov	r3, #-1
 371 000e 0122     		movs	r2, #1
 372 0010 2146     		mov	r1, r4
 373 0012 2868     		ldr	r0, [r5]
 374 0014 FFF7FEFF 		bl	HAL_I2C_IsDeviceReady
 375              	.LVL35:
  72:stm32/lcd-i2c.c ****       break;
 376              		.loc 1 72 0
 377 0018 0028     		cmp	r0, #0
 378 001a F6D1     		bne	.L25
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 379              		.loc 1 85 0
 380 001c 4FF0FF37 		mov	r7, #-1
  77:stm32/lcd-i2c.c **** 
 381              		.loc 1 77 0
 382 0020 3301     		lsls	r3, r6, #4
 383 0022 DBB2     		uxtb	r3, r3
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 10


  83:stm32/lcd-i2c.c **** 
 384              		.loc 1 83 0
 385 0024 43F00902 		orr	r2, r3, #9
  76:stm32/lcd-i2c.c ****   uint8_t lo = (data << 4) & 0xF0;
 386              		.loc 1 76 0
 387 0028 06F0F006 		and	r6, r6, #240
 388              	.LVL36:
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 389              		.loc 1 85 0
 390 002c 2146     		mov	r1, r4
 391 002e 2868     		ldr	r0, [r5]
 392              	.LVL37:
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 393              		.loc 1 80 0
 394 0030 46F00D04 		orr	r4, r6, #13
  82:stm32/lcd-i2c.c ****   data_arr[3] = lo | flags | BACKLIGHT;
 395              		.loc 1 82 0
 396 0034 43F00D05 		orr	r5, r3, #13
  83:stm32/lcd-i2c.c **** 
 397              		.loc 1 83 0
 398 0038 8DF80F20 		strb	r2, [sp, #15]
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 399              		.loc 1 85 0
 400 003c 0423     		movs	r3, #4
 401              	.LVL38:
 402 003e 03AA     		add	r2, sp, #12
 403 0040 0097     		str	r7, [sp]
  81:stm32/lcd-i2c.c ****   data_arr[2] = lo | flags | BACKLIGHT | PIN_EN;
 404              		.loc 1 81 0
 405 0042 46F00906 		orr	r6, r6, #9
 406              	.LVL39:
  82:stm32/lcd-i2c.c ****   data_arr[3] = lo | flags | BACKLIGHT;
 407              		.loc 1 82 0
 408 0046 8DF80E50 		strb	r5, [sp, #14]
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 409              		.loc 1 80 0
 410 004a 8DF80C40 		strb	r4, [sp, #12]
  81:stm32/lcd-i2c.c ****   data_arr[2] = lo | flags | BACKLIGHT | PIN_EN;
 411              		.loc 1 81 0
 412 004e 8DF80D60 		strb	r6, [sp, #13]
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 413              		.loc 1 85 0
 414 0052 FFF7FEFF 		bl	HAL_I2C_Master_Transmit
 415              	.LVL40:
  86:stm32/lcd-i2c.c ****   return res;
 416              		.loc 1 86 0
 417 0056 0520     		movs	r0, #5
 418 0058 FFF7FEFF 		bl	HAL_Delay
 419              	.LVL41:
 420              	.LBE22:
 421              	.LBE21:
  97:stm32/lcd-i2c.c ****   LCD_SendInternal(lcd_addr, data, PIN_RS);
  98:stm32/lcd-i2c.c **** }
 422              		.loc 1 98 0
 423 005c 05B0     		add	sp, sp, #20
 424              	.LCFI11:
 425              		.cfi_def_cfa_offset 20
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 11


 426              		@ sp needed
 427 005e F0BD     		pop	{r4, r5, r6, r7, pc}
 428              	.L29:
 429              		.align	2
 430              	.L28:
 431 0060 00000000 		.word	.LANCHOR0
 432              		.cfi_endproc
 433              	.LFE709:
 435              		.section	.text.LCD_Init,"ax",%progbits
 436              		.align	1
 437              		.p2align 2,,3
 438              		.global	LCD_Init
 439              		.syntax unified
 440              		.thumb
 441              		.thumb_func
 442              		.fpu softvfp
 444              	LCD_Init:
 445              	.LFB710:
  99:stm32/lcd-i2c.c **** //-------------------------------------------------------------------------------
 100:stm32/lcd-i2c.c **** void LCD_Init(I2C_HandleTypeDef *HI2C, uint8_t lcd_addr)
 101:stm32/lcd-i2c.c **** {
 446              		.loc 1 101 0
 447              		.cfi_startproc
 448              		@ args = 0, pretend = 0, frame = 8
 449              		@ frame_needed = 0, uses_anonymous_args = 0
 450              	.LVL42:
 451 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 452              	.LCFI12:
 453              		.cfi_def_cfa_offset 20
 454              		.cfi_offset 4, -20
 455              		.cfi_offset 5, -16
 456              		.cfi_offset 6, -12
 457              		.cfi_offset 7, -8
 458              		.cfi_offset 14, -4
 102:stm32/lcd-i2c.c **** 	pHI2C = HI2C;
 459              		.loc 1 102 0
 460 0002 324D     		ldr	r5, .L41
 101:stm32/lcd-i2c.c **** 	pHI2C = HI2C;
 461              		.loc 1 101 0
 462 0004 85B0     		sub	sp, sp, #20
 463              	.LCFI13:
 464              		.cfi_def_cfa_offset 40
 465 0006 0C46     		mov	r4, r1
 466              		.loc 1 102 0
 467 0008 2860     		str	r0, [r5]
 468              	.LVL43:
 469 000a 00E0     		b	.L32
 470              	.LVL44:
 471              	.L40:
 472 000c 2868     		ldr	r0, [r5]
 473              	.LVL45:
 474              	.L32:
 475              	.LBB39:
 476              	.LBB40:
 477              	.LBB41:
  71:stm32/lcd-i2c.c ****     if (res == HAL_OK)
 478              		.loc 1 71 0
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 12


 479 000e 4FF0FF33 		mov	r3, #-1
 480 0012 0122     		movs	r2, #1
 481 0014 2146     		mov	r1, r4
 482 0016 FFF7FEFF 		bl	HAL_I2C_IsDeviceReady
 483              	.LVL46:
  72:stm32/lcd-i2c.c ****       break;
 484              		.loc 1 72 0
 485 001a 0028     		cmp	r0, #0
 486 001c F6D1     		bne	.L40
 487              	.LVL47:
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 488              		.loc 1 85 0
 489 001e 4FF0FF33 		mov	r3, #-1
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 490              		.loc 1 80 0
 491 0022 2B4A     		ldr	r2, .L41+4
 492 0024 04AE     		add	r6, sp, #16
 493 0026 46F8042D 		str	r2, [r6, #-4]!
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 494              		.loc 1 85 0
 495 002a 2868     		ldr	r0, [r5]
 496              	.LVL48:
 497 002c 3246     		mov	r2, r6
 498 002e 0093     		str	r3, [sp]
 499 0030 2146     		mov	r1, r4
 500 0032 0423     		movs	r3, #4
 501 0034 FFF7FEFF 		bl	HAL_I2C_Master_Transmit
 502              	.LVL49:
  86:stm32/lcd-i2c.c ****   return res;
 503              		.loc 1 86 0
 504 0038 0520     		movs	r0, #5
 505 003a FFF7FEFF 		bl	HAL_Delay
 506              	.LVL50:
 507              	.L33:
 508              	.LBE41:
 509              	.LBE40:
 510              	.LBE39:
 511              	.LBB42:
 512              	.LBB43:
 513              	.LBB44:
  71:stm32/lcd-i2c.c ****     if (res == HAL_OK)
 514              		.loc 1 71 0
 515 003e 4FF0FF33 		mov	r3, #-1
 516 0042 0122     		movs	r2, #1
 517 0044 2146     		mov	r1, r4
 518 0046 2868     		ldr	r0, [r5]
 519 0048 FFF7FEFF 		bl	HAL_I2C_IsDeviceReady
 520              	.LVL51:
  72:stm32/lcd-i2c.c ****       break;
 521              		.loc 1 72 0
 522 004c 0028     		cmp	r0, #0
 523 004e F6D1     		bne	.L33
 524              	.LVL52:
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 525              		.loc 1 85 0
 526 0050 4FF0FF33 		mov	r3, #-1
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 13


 527              		.loc 1 80 0
 528 0054 1F4F     		ldr	r7, .L41+8
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 529              		.loc 1 85 0
 530 0056 2868     		ldr	r0, [r5]
 531              	.LVL53:
 532 0058 3246     		mov	r2, r6
 533 005a 0093     		str	r3, [sp]
 534 005c 2146     		mov	r1, r4
 535 005e 0423     		movs	r3, #4
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 536              		.loc 1 80 0
 537 0060 0397     		str	r7, [sp, #12]
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 538              		.loc 1 85 0
 539 0062 FFF7FEFF 		bl	HAL_I2C_Master_Transmit
 540              	.LVL54:
  86:stm32/lcd-i2c.c ****   return res;
 541              		.loc 1 86 0
 542 0066 0520     		movs	r0, #5
 543 0068 FFF7FEFF 		bl	HAL_Delay
 544              	.LVL55:
 545              	.L34:
 546              	.LBE44:
 547              	.LBE43:
 548              	.LBE42:
 549              	.LBB45:
 550              	.LBB46:
 551              	.LBB47:
  71:stm32/lcd-i2c.c ****     if (res == HAL_OK)
 552              		.loc 1 71 0
 553 006c 4FF0FF33 		mov	r3, #-1
 554 0070 0122     		movs	r2, #1
 555 0072 2146     		mov	r1, r4
 556 0074 2868     		ldr	r0, [r5]
 557 0076 FFF7FEFF 		bl	HAL_I2C_IsDeviceReady
 558              	.LVL56:
  72:stm32/lcd-i2c.c ****       break;
 559              		.loc 1 72 0
 560 007a 0028     		cmp	r0, #0
 561 007c F6D1     		bne	.L34
 562              	.LVL57:
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 563              		.loc 1 85 0
 564 007e 4FF0FF33 		mov	r3, #-1
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 565              		.loc 1 80 0
 566 0082 154F     		ldr	r7, .L41+12
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 567              		.loc 1 85 0
 568 0084 2868     		ldr	r0, [r5]
 569              	.LVL58:
 570 0086 3246     		mov	r2, r6
 571 0088 0093     		str	r3, [sp]
 572 008a 2146     		mov	r1, r4
 573 008c 0423     		movs	r3, #4
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 14


 574              		.loc 1 80 0
 575 008e 0397     		str	r7, [sp, #12]
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 576              		.loc 1 85 0
 577 0090 FFF7FEFF 		bl	HAL_I2C_Master_Transmit
 578              	.LVL59:
  86:stm32/lcd-i2c.c ****   return res;
 579              		.loc 1 86 0
 580 0094 0520     		movs	r0, #5
 581 0096 FFF7FEFF 		bl	HAL_Delay
 582              	.LVL60:
 583              	.L35:
 584              	.LBE47:
 585              	.LBE46:
 586              	.LBE45:
 587              	.LBB48:
 588              	.LBB49:
 589              	.LBB50:
  71:stm32/lcd-i2c.c ****     if (res == HAL_OK)
 590              		.loc 1 71 0
 591 009a 4FF0FF33 		mov	r3, #-1
 592 009e 0122     		movs	r2, #1
 593 00a0 2146     		mov	r1, r4
 594 00a2 2868     		ldr	r0, [r5]
 595 00a4 FFF7FEFF 		bl	HAL_I2C_IsDeviceReady
 596              	.LVL61:
  72:stm32/lcd-i2c.c ****       break;
 597              		.loc 1 72 0
 598 00a8 0028     		cmp	r0, #0
 599 00aa F6D1     		bne	.L35
 600              	.LVL62:
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 601              		.loc 1 85 0
 602 00ac 4FF0FF33 		mov	r3, #-1
 603 00b0 2868     		ldr	r0, [r5]
 604              	.LVL63:
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 605              		.loc 1 80 0
 606 00b2 0A4D     		ldr	r5, .L41+16
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 607              		.loc 1 85 0
 608 00b4 3246     		mov	r2, r6
 609 00b6 2146     		mov	r1, r4
 610 00b8 0093     		str	r3, [sp]
 611 00ba 0423     		movs	r3, #4
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 612              		.loc 1 80 0
 613 00bc 0395     		str	r5, [sp, #12]
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 614              		.loc 1 85 0
 615 00be FFF7FEFF 		bl	HAL_I2C_Master_Transmit
 616              	.LVL64:
  86:stm32/lcd-i2c.c ****   return res;
 617              		.loc 1 86 0
 618 00c2 0520     		movs	r0, #5
 619 00c4 FFF7FEFF 		bl	HAL_Delay
 620              	.LVL65:
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 15


 621              	.LBE50:
 622              	.LBE49:
 623              	.LBE48:
 103:stm32/lcd-i2c.c **** 
 104:stm32/lcd-i2c.c ****   // 4-bit mode, 2 lines, 5x7 format
 105:stm32/lcd-i2c.c ****   LCD_SendCommand(lcd_addr, 0b00110000);
 106:stm32/lcd-i2c.c ****   // display & cursor home (keep this!)
 107:stm32/lcd-i2c.c ****   LCD_SendCommand(lcd_addr, 0b00000010);
 108:stm32/lcd-i2c.c ****   // display on, right shift, underline off, blink off
 109:stm32/lcd-i2c.c ****   LCD_SendCommand(lcd_addr, 0b00001100);
 110:stm32/lcd-i2c.c ****   // clear display (optional here)
 111:stm32/lcd-i2c.c ****   LCD_SendCommand(lcd_addr, 0b00000001);
 112:stm32/lcd-i2c.c **** }
 624              		.loc 1 112 0
 625 00c8 05B0     		add	sp, sp, #20
 626              	.LCFI14:
 627              		.cfi_def_cfa_offset 20
 628              		@ sp needed
 629 00ca F0BD     		pop	{r4, r5, r6, r7, pc}
 630              	.L42:
 631              		.align	2
 632              	.L41:
 633 00cc 00000000 		.word	.LANCHOR0
 634 00d0 3C380C08 		.word	135018556
 635 00d4 0C082C28 		.word	673974284
 636 00d8 0C08CCC8 		.word	-926152692
 637 00dc 0C081C18 		.word	404490252
 638              		.cfi_endproc
 639              	.LFE710:
 641              		.section	.text.LCD_SendString,"ax",%progbits
 642              		.align	1
 643              		.p2align 2,,3
 644              		.global	LCD_SendString
 645              		.syntax unified
 646              		.thumb
 647              		.thumb_func
 648              		.fpu softvfp
 650              	LCD_SendString:
 651              	.LFB711:
 113:stm32/lcd-i2c.c **** //-------------------------------------------------------------------------------
 114:stm32/lcd-i2c.c **** void LCD_SendString(uint8_t lcd_addr, char *str)
 115:stm32/lcd-i2c.c **** {
 652              		.loc 1 115 0
 653              		.cfi_startproc
 654              		@ args = 0, pretend = 0, frame = 8
 655              		@ frame_needed = 0, uses_anonymous_args = 0
 656              	.LVL66:
 657 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 658              	.LCFI15:
 659              		.cfi_def_cfa_offset 28
 660              		.cfi_offset 4, -28
 661              		.cfi_offset 5, -24
 662              		.cfi_offset 6, -20
 663              		.cfi_offset 7, -16
 664              		.cfi_offset 8, -12
 665              		.cfi_offset 9, -8
 666              		.cfi_offset 14, -4
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 16


 116:stm32/lcd-i2c.c ****   while (*str)
 667              		.loc 1 116 0
 668 0004 0C78     		ldrb	r4, [r1]	@ zero_extendqisi2
 115:stm32/lcd-i2c.c ****   while (*str)
 669              		.loc 1 115 0
 670 0006 85B0     		sub	sp, sp, #20
 671              	.LCFI16:
 672              		.cfi_def_cfa_offset 48
 673              		.loc 1 116 0
 674 0008 84B3     		cbz	r4, .L43
 675 000a 8846     		mov	r8, r1
 676              	.LBB55:
 677              	.LBB56:
 678              	.LBB57:
  71:stm32/lcd-i2c.c ****     if (res == HAL_OK)
 679              		.loc 1 71 0
 680 000c 4FF0FF39 		mov	r9, #-1
 681 0010 184E     		ldr	r6, .L53
 682 0012 85B2     		uxth	r5, r0
 683              	.LVL67:
 684              	.L45:
 685 0014 4FF0FF33 		mov	r3, #-1
 686 0018 0122     		movs	r2, #1
 687 001a 2946     		mov	r1, r5
 688 001c 3068     		ldr	r0, [r6]
 689 001e FFF7FEFF 		bl	HAL_I2C_IsDeviceReady
 690              	.LVL68:
  72:stm32/lcd-i2c.c ****       break;
 691              		.loc 1 72 0
 692 0022 0028     		cmp	r0, #0
 693 0024 F6D1     		bne	.L45
  77:stm32/lcd-i2c.c **** 
 694              		.loc 1 77 0
 695 0026 2301     		lsls	r3, r4, #4
 696 0028 DBB2     		uxtb	r3, r3
  76:stm32/lcd-i2c.c ****   uint8_t lo = (data << 4) & 0xF0;
 697              		.loc 1 76 0
 698 002a 04F0F004 		and	r4, r4, #240
 699              	.LVL69:
  82:stm32/lcd-i2c.c ****   data_arr[3] = lo | flags | BACKLIGHT;
 700              		.loc 1 82 0
 701 002e 43F00D0E 		orr	lr, r3, #13
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 702              		.loc 1 80 0
 703 0032 44F00D0C 		orr	ip, r4, #13
  83:stm32/lcd-i2c.c **** 
 704              		.loc 1 83 0
 705 0036 43F00907 		orr	r7, r3, #9
  81:stm32/lcd-i2c.c ****   data_arr[2] = lo | flags | BACKLIGHT | PIN_EN;
 706              		.loc 1 81 0
 707 003a 44F00904 		orr	r4, r4, #9
 708              	.LVL70:
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 709              		.loc 1 85 0
 710 003e 0423     		movs	r3, #4
 711              	.LVL71:
 712 0040 03AA     		add	r2, sp, #12
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 17


 713 0042 2946     		mov	r1, r5
 714 0044 3068     		ldr	r0, [r6]
 715              	.LVL72:
 716 0046 CDF80090 		str	r9, [sp]
  82:stm32/lcd-i2c.c ****   data_arr[3] = lo | flags | BACKLIGHT;
 717              		.loc 1 82 0
 718 004a 8DF80EE0 		strb	lr, [sp, #14]
  80:stm32/lcd-i2c.c ****   data_arr[1] = up | flags | BACKLIGHT;
 719              		.loc 1 80 0
 720 004e 8DF80CC0 		strb	ip, [sp, #12]
  81:stm32/lcd-i2c.c ****   data_arr[2] = lo | flags | BACKLIGHT | PIN_EN;
 721              		.loc 1 81 0
 722 0052 8DF80D40 		strb	r4, [sp, #13]
  83:stm32/lcd-i2c.c **** 
 723              		.loc 1 83 0
 724 0056 8DF80F70 		strb	r7, [sp, #15]
  85:stm32/lcd-i2c.c ****   HAL_Delay(LCD_DELAY_MS);
 725              		.loc 1 85 0
 726 005a FFF7FEFF 		bl	HAL_I2C_Master_Transmit
 727              	.LVL73:
  86:stm32/lcd-i2c.c ****   return res;
 728              		.loc 1 86 0
 729 005e 0520     		movs	r0, #5
 730 0060 FFF7FEFF 		bl	HAL_Delay
 731              	.LVL74:
 732              	.LBE57:
 733              	.LBE56:
 734              	.LBE55:
 735              		.loc 1 116 0
 736 0064 18F8014F 		ldrb	r4, [r8, #1]!	@ zero_extendqisi2
 737              	.LVL75:
 738 0068 002C     		cmp	r4, #0
 739 006a D3D1     		bne	.L45
 740              	.LVL76:
 741              	.L43:
 117:stm32/lcd-i2c.c ****     {
 118:stm32/lcd-i2c.c ****     LCD_SendData(lcd_addr, (uint8_t) (*str));
 119:stm32/lcd-i2c.c ****     str++;
 120:stm32/lcd-i2c.c ****     }
 121:stm32/lcd-i2c.c **** }
 742              		.loc 1 121 0
 743 006c 05B0     		add	sp, sp, #20
 744              	.LCFI17:
 745              		.cfi_def_cfa_offset 28
 746              		@ sp needed
 747 006e BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 748              	.L54:
 749 0072 00BF     		.align	2
 750              	.L53:
 751 0074 00000000 		.word	.LANCHOR0
 752              		.cfi_endproc
 753              	.LFE711:
 755              		.global	pHI2C
 756              		.section	.bss.pHI2C,"aw",%nobits
 757              		.align	2
 758              		.set	.LANCHOR0,. + 0
 761              	pHI2C:
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 18


 762 0000 00000000 		.space	4
 763              		.section	.rodata.I2C_Scan.str1.4,"aMS",%progbits,1
 764              		.align	2
 765              	.LC1:
 766 0000 30782530 		.ascii	"0x%02X\000"
 766      325800
 767 0007 00       		.space	1
 768              	.LC2:
 769 0008 2E00     		.ascii	".\000"
 770 000a 0000     		.space	2
 771              	.LC3:
 772 000c 0D0A00   		.ascii	"\015\012\000"
 773 000f 00       		.space	1
 774              	.LC0:
 775 0010 5363616E 		.ascii	"Scanning I2C bus...\015\012\000"
 775      6E696E67 
 775      20493243 
 775      20627573 
 775      2E2E2E0D 
 776              		.text
 777              	.Letext0:
 778              		.file 2 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/machine/_default_types
 779              		.file 3 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/sys/lock.h"
 780              		.file 4 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/sys/_types.h"
 781              		.file 5 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h
 782              		.file 6 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/sys/reent.h"
 783              		.file 7 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/sys/_stdint.h"
 784              		.file 8 "Drivers/CMSIS/Include/core_cm3.h"
 785              		.file 9 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/system_stm32f1xx.h"
 786              		.file 10 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/stm32f103xb.h"
 787              		.file 11 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_def.h"
 788              		.file 12 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_dma.h"
 789              		.file 13 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_i2c.h"
 790              		.file 14 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal.h"
 791              		.file 15 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_ll_tim.h"
 792              		.file 16 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_ll_dma.h"
 793              		.file 17 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/math.h"
 794              		.file 18 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/stdlib.h"
 795              		.file 19 "grbl/settings.h"
 796              		.file 20 "grbl/system.h"
 797              		.file 21 "grbl/gcode.h"
 798              		.file 22 "stm32/stm32utilities.h"
 799              		.file 23 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/stdio.h"
ARM GAS  /var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s 			page 19


DEFINED SYMBOLS
                            *ABS*:0000000000000000 lcd-i2c.c
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:16     .text.I2C_Scan:0000000000000000 $t
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:24     .text.I2C_Scan:0000000000000000 I2C_Scan
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:124    .text.I2C_Scan:0000000000000064 $d
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:133    .text.LCD_SendInternal:0000000000000000 $t
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:141    .text.LCD_SendInternal:0000000000000000 LCD_SendInternal
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:229    .text.LCD_SendInternal:000000000000006c $d
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:234    .text.LCD_SendCommand:0000000000000000 $t
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:242    .text.LCD_SendCommand:0000000000000000 LCD_SendCommand
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:330    .text.LCD_SendCommand:0000000000000060 $d
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:335    .text.LCD_SendData:0000000000000000 $t
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:343    .text.LCD_SendData:0000000000000000 LCD_SendData
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:431    .text.LCD_SendData:0000000000000060 $d
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:436    .text.LCD_Init:0000000000000000 $t
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:444    .text.LCD_Init:0000000000000000 LCD_Init
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:633    .text.LCD_Init:00000000000000cc $d
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:642    .text.LCD_SendString:0000000000000000 $t
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:650    .text.LCD_SendString:0000000000000000 LCD_SendString
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:751    .text.LCD_SendString:0000000000000074 $d
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:761    .bss.pHI2C:0000000000000000 pHI2C
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:757    .bss.pHI2C:0000000000000000 $d
/var/folders/m1/3lv6xmzs0mlckxs4mx90nfb40000gn/T//ccVRNGbq.s:764    .rodata.I2C_Scan.str1.4:0000000000000000 $d

UNDEFINED SYMBOLS
uart_sendstr
sprintf
HAL_I2C_IsDeviceReady
HAL_I2C_Master_Transmit
HAL_Delay
